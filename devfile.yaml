schemaVersion: 2.2.0
metadata:
  name: rhdh-the-adventure-dev
  version: 1.0.0
  description: Devfile for developing this repository
  tags:
    - Asciidoc
    - Antora
projects:
  - name: rhdh-the-adventure
    git:
      remotes:
        origin: "https://github.com/rmarting/rhdh-adventure.git"
      checkoutFrom:
        revision: master
components:
  - name: dev-container
    container:
      image: quay.io/devfile/universal-developer-image:ubi8-latest
      memoryLimit: 512Mi
      #mountSources: true
      #volumeMounts:
      #  - name: node-modules
      #    path: "/projects/rhdh-adventure/node_modules"
      endpoints:
        - name: "site"
          targetPort: 3000
          exposure: public
          protocol: http
  #- name: vscode-editor
  #  type: cheEditor
  #  attributes:
  #    ide: vscode
  #    extensions:
  #      - redhat.vscode-yaml
  #      #- davidanson.vscode-markdownlint
  #      #- streetsidesoftware.code-spell-checker
commands:
  - id: install-gulp
    exec:
      component: dev-container
      commandLine: "npm install"
      workingDir: "/projects/rhdh-adventure" # "${CHE_PROJECTS_ROOT}" # Use the root project directory
      group:
        kind: build
        isDefault: true
  - id: install-npm
    exec:
      component: dev-container
      commandLine: "npm install"
      workingDir: "/projects/rhdh-adventure" # "${CHE_PROJECTS_ROOT}" # Use the root project directory
      group:
        kind: build
        isDefault: true
  - id: run-dev-site
    exec:
      component: dev-container
      commandLine: "gulp"
      workingDir: "/projects/rhdh-adventure"
      group:
        kind: run
        isDefault: true
events:
  preStart:
    - install-gulp
    - install
  #postStop:
  #  - id: cleanup
  #    exec:
  #      component: nodejs
  #      commandLine: "npm run clean"
#volumes:
#  - name: node-modules
#    size: 1Gi
